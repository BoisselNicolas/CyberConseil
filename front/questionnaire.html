<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="css/questionnaire.css">
</head>

    <!-- multistep form -->
    <form id="msform">
        <!-- progressbar -->
        <ul id="progressbar">
            <li class=" li"></li>
            <li class=" li"></li>
            <li class=" li"></li>
            <li class=" li"></li>
        </ul>
        <!-- fieldsets -->

        <fieldset >
            <h2 id="title" class="fs-title"></h2>
            <div id="question"></div>
        </fieldset>
       
    </form>
</html>

<script>

function CallAPI(id_question) {
    const requestOptions = {
        method: "GET",
        headers: { "Content-Type": "application/json" }
    } 

    fetch("http://localhost:3000/getQuestions?id_question="+id_question, requestOptions)
        .then((responseStatus) => responseStatus.json())
        .then((data) => { 
            var i =1;
            document.getElementById('question').innerHTML = ""
            document.getElementById('title').innerHTML=""
            for(let t of data ){

                document.getElementById('title').append(t.question)
                for (const [key, value] of Object.entries(t.response)) {
                    document.getElementById('question').innerHTML = document.getElementById('question').innerHTML + `<input id="${i}" type="button" next_id="${value['next_id']}" class="action-button" value="${value['value']}" />`
                    i++

                }
            }
            var elements = document.getElementsByClassName("action-button");
            var OnClickFunction = function() {
                var attribute = this.getAttribute("next_id");
                CallAPI(attribute)

            };
            for (var i = 0; i < elements.length; i++) {
                elements[i].addEventListener('click', OnClickFunction, false);
            }
            var elm = document.getElementsByClassName('li')
            var o = document.getElementsByClassName('active').length 
            elm[o].classList.add("active");
        });
}


CallAPI(1)


</script>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"> 
</script>


<script src="js/index.js"></script>


